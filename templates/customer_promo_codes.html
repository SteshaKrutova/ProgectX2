{% extends "base.html" %}

{% block title %}–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏ - ProjectX2{% endblock %}

{% block content %}
<div class="admin-container">
    <div class="admin-header">
        <h2>üé´ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏</h2>
        <p class="admin-subtitle">–°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤</p>
    </div>

    <!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞ -->
    <div class="form-section">
        <h3>‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–º–æ–∫–æ–¥</h3>
        <form method="POST" action="{{ url_for('create_promo_code') }}" class="auth-form">
            <div class="form-row">
                <div class="form-group" style="flex: 1;">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞:</label>
                    <input type="text" name="code" class="form-input" required 
                        placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –õ–µ—Ç–æ2024 –∏–ª–∏ summer24">
                </div>
                
                <div class="form-group" style="margin-left: auto; min-width: 120px;">
                    <label>–°—É–º–º–∞ (—Ä—É–±.):</label>
                    <input type="number" name="amount" class="form-input" required 
                        min="1" step="1" placeholder="100">
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 10px;">
                <button type="submit" class="btn btn-success">–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥</button>
            </div>
        </form>
    </div>


    <!-- –°–ø–∏—Å–æ–∫ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ -->
    <div class="promo-codes-section">
        <h3>üìã –ú–æ–∏ –ø—Ä–æ–º–æ–∫–æ–¥—ã</h3>
        
        {% if promo_codes %}
            <div class="table-responsive">
                <table class="users-table">
                    <thead>
                        <tr>
                            <th>–ü—Ä–æ–º–æ–∫–æ–¥</th>
                            <th>–°—É–º–º–∞</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for promo in promo_codes %}
                        <tr>
                            <td><strong>{{ promo.code }}</strong></td>
                            <td>{{ promo.amount }} —Ä—É–±.</td>
                            <td>
                                <span class="status-{{ 'active' if promo.is_active else 'inactive' }}">
                                    {{ '–ê–∫—Ç–∏–≤–µ–Ω' if promo.is_active else '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω' }}
                                </span>
                            </td>
                            <td>{{ promo.created_at.strftime('%d.%m.%Y %H:%M') }}</td>
                            <td class="user-actions">
                                <a href="{{ url_for('toggle_promo_code', promo_id=promo.id) }}" 
                                   class="btn btn-sm btn-{{ 'success' if not promo.is_active else 'warning' }}">
                                    {{ '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å' if not promo.is_active else '–î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å' }}
                                </a>
                                <a href="{{ url_for('delete_promo_code', promo_id=promo.id) }}" 
                                   class="btn btn-sm btn-danger"
                                   onclick="return confirm('–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ {{ promo.code }}?')">
                                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <div class="empty-state">
                <div class="empty-icon">üé´</div>
                <h4>–ü—Ä–æ–º–æ–∫–æ–¥—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h4>
                <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤.</p>
            </div>
        {% endif %}
    </div>

    <div class="admin-actions">
        <a href="{{ url_for('index') }}" class="btn btn-info">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
    </div>
</div>

<style>
.form-row {
    display: flex;
    gap: 15px;
    align-items: flex-end;
}

@media (max-width: 768px) {
    .form-row {
        flex-direction: column;
    }
    
    .form-group {
        margin-left: 0 !important;
        min-width: auto !important;
    }
.form-section {
    background: white;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    margin-bottom: 25px;
}

.form-section h3 {
    margin-top: 0;
    color: #2c3e50;
}

.promo-codes-section {
    background: white;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.auth-form {
    max-width: 400px;
}

.form-group {
    margin-bottom: 15px;
}

.form-input {
    width: 100%;
    padding: 10px;
    border: 2px solid #e0e0e0;
    border-radius: 5px;
    font-size: 16px;
}

.btn-success {
    background: #28a745;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

.status-active {
    color: #28a745;
    font-weight: 500;
}

.status-inactive {
    color: #dc3545;
    font-weight: 500;
}
</style>
{% endblock %}